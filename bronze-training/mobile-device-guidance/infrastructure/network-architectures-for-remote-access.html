<!--
title: Network architectures
description: Advice for network architects and systems administrators on the design of remote access architecture for enterprise services
published: true
date: 2021-03-06T02:55:47.973Z
tags: guidance, bronze, mdm
editor: ckeditor
dateCreated: 2021-03-06T02:55:47.973Z
-->

<p>When deciding how to enable remote users to access enterprise resources, there are a number of security issues to take into account.&nbsp;This guidance outlines two approaches to this problem,&nbsp;<i>a traditional VPN-based remote access architecture</i>, and&nbsp;<i>a zero trust&nbsp;architecture</i>.&nbsp;</p>
<p>If you have on-premises resources, using a <a href="https://www.ncsc.gov.uk/collection/mobile-device-guidance/infrastructure/network-architectures-for-remote-access#trad">traditional VPN-based remote access architecture</a> - the&nbsp;<i>walled garden approach -</i>&nbsp;is one way of balancing remote usability with the risk of compromise.</p>
<p>If you have few or no on-premises services, the <a href="https://www.ncsc.gov.uk/collection/mobile-device-guidance/infrastructure/network-architectures-for-remote-access#zero"><i>zero trust architecture</i></a><i>&nbsp;</i>can be very effective.</p>
<p>These two approaches are not the only options for enabling remote access, nor are they mutually exclusive. A hybrid approach can be taken if required, adopting properties from each.</p>
<p>If a traditional remote access approach is necessary, adopting some of the principles and defences from the&nbsp;<i>zero trust&nbsp;architecture</i>&nbsp;will help you mitigate additional threats, and make a transition to full&nbsp;<i>zero trust networking</i>&nbsp;easier in future.</p>
<h2>1.&nbsp;Traditional VPN-based remote access architecture</h2>
<p>The traditional remote access architecture separates a remote access architecture into a strong outer perimeter and multiple internal layers that are separated using firewalls.&nbsp;</p>
<figure class="image image_resized" style="width:auto;"><img src="https://www.ncsc.gov.uk/static-assets/images/guidance/Walled%20Garden.png"></figure>
<h3><strong>Key components</strong></h3>
<p>At a high level, these layers of this&nbsp;<i>walled garden</i>&nbsp;are:</p>
<ul>
  <li>The access layer, authenticating remote devices. Network traffic from remote devices is trapped here unless it can subsequently authenticate to local services</li>
  <li>The presentation layer, brokering access to internal services based on corporate policy</li>
  <li>A core network, comprising of on-premise services</li>
  <li>An internet gateway, providing proxy access to remote websites and enterprise cloud services</li>
</ul>
<h3><strong>How to set up a traditional remote access architecture</strong></h3>
<p>Firstly, if you are designing a new network, consider following the<i>&nbsp;zero trust network</i>&nbsp;approach instead. The traditional architecture still makes sense where there is a considerable on-premises deployment and/or legacy services to use. However, a&nbsp;<i>zero trust</i>&nbsp;approach will likely be better for organisations predominantly consuming cloud services.</p>
<p>With the traditional architecture, the solution – comprising all layers – should require both user and machine authentication before allowing access to enterprise services. Both of these should be tied together so that a particular user can only access their assigned device. Typically, the access layer will perform&nbsp;<i>machine</i>&nbsp;authentication, and the presentation layer will perform&nbsp;<i>user</i>&nbsp;authentication.</p>
<h4><strong>Access layer</strong></h4>
<p>Some deployments will have a single set of services that are accessible to all remote users (and hence be very simple in design), others will require more complex authentication and authorisation solutions to enable different remote users to access specific services, potentially depending on device type. Which services the user and device can access will depend on the rules enforced within the access layer.</p>
<p>The access layer should authenticate clients and terminate their&nbsp;virtual private network (VPN)&nbsp;connection. The access layer also provides defences against network-level attack on internal services, from the Internet. These defences may be included as part of the VPN service. If not, you may require a separate device, such as a firewall, on the network boundary, permitting only VPN traffic into the access layer.</p>
<p>Routing rules should be in place within the access layer to stop remote devices communicating with one another, unless explicitly required.</p>
<h4><strong>Presentation layer</strong></h4>
<p>The presentation layer presents a subset of enterprise services to devices, authenticating users as they connect to enterprise services.</p>
<p>If practically possible, you should attempt to provide a layer of abstraction between the remote device&nbsp;and your central services. This will usually involve breaking end-to-end encryption (as happens in a reverse proxy or load balancer). Examples include:</p>
<ul>
  <li>a read-only domain controller (RODC)</li>
  <li>remote desktop/app services</li>
  <li>a reverse authenticating proxy brokering access to an internal intranet site</li>
</ul>
<p>The use of abstraction in the presentation layer lowers the risk of a network attack on enterprise services from a compromised device. Protective monitoring tools can be used here if required.</p>
<h4><strong>Internet gateway</strong></h4>
<p>Some organisations require proxy servers to intercept traffic for monitoring or to block access to internet services. An internet gateway is typically used to achieve this, and will use custom CA certificates deployed to devices to&nbsp;enable it to inspect encrypted traffic.</p>
<p>Whilst organisations&nbsp; might be required by legislation to monitor users' traffic in a gateway, protective monitoring, for security reasons, is often more effective when deployed to devices&nbsp;via security configuration (see&nbsp;<a href="https://www.ncsc.gov.uk/collection/mobile-device-guidance/platform-guides">detailed platform guides</a>) or<a href="https://www.ncsc.gov.uk/collection/mobile-device-guidance/antivirus-and-other-security-software">&nbsp;security applications</a>.&nbsp;Several other reasons to use intercepting proxies are given in the&nbsp;<a href="https://www.ncsc.gov.uk/collection/mobile-device-guidance/virtual-private-networks">VPN guidance</a>.</p>
<h2>2.&nbsp;Zero trust architecture</h2>
<p>A zero trust architecture removes the inherent trust from the network while building confidence in each request. This is achieved through building context through strong authentication, authorisation, device health, and value of the data being accessed.</p>
<p>Each connection is strongly authenticated and checked against permissible policies, with the connection being dropped if it is not explicitly allowed.</p>
<figure class="image image_resized" style="width:auto;"><img src="https://www.ncsc.gov.uk/static-assets/images/guidance/byodpc.sdxml.png"></figure>
<p>This approach has many advantages if adopted correctly, but also presents additional risk if mistakes are made.</p>
<p>Whilst this article will not go into detail about how to implement a&nbsp;<i>zero trust</i>&nbsp;approach, we will give some high-level recommendations.</p>
<h3><strong>Preparing for a zero trust architecture</strong></h3>
<p>Whilst the architectural components look much simpler in a zero trust network approach, it is still important to implement authentication and encryption mechanisms to the same or to a greater standard. It also becomes more important to have a&nbsp;<a href="https://www.ncsc.gov.uk/collection/mobile-device-guidance/platform-guides">strong device configuration</a>, as the device is exposed to a larger set of risks. This section details some things you should think about when developing a zero trust architecture.</p>
<h4><strong>Single strong source of user identity</strong></h4>
<p>User identities are the foundation of a zero trust approach. By consolidating users' roles into a single source of truth, you can build reliable rules for users accessing data. The usual approach would be to use a single user directory for your organisation and create accounts that are linked to individuals. Then to enable granular access control you can create specific roles for each user. The directory can then be used across all services you plan to use, both internally and externally.</p>
<h4><strong>User authentication</strong></h4>
<p>Users should be&nbsp;<a href="https://www.ncsc.gov.uk/collection/mobile-device-guidance/enterprise-authentication-policy">strongly authenticated</a>,&nbsp;using multi-factor authentication to mitigate password attacks. The authentication should use an enterprise single sign on (SSO) service, which accesses your single source of user identity. This automates and simplifies credential management for users. It also simplifies your joiners/movers/leavers processes.&nbsp;</p>
<h4><strong>Machine authentication</strong></h4>
<p>Machine authentication can take place at the same time as user authentication, and can be implicit. For example, a device issued to a single user, which itself performs user authentication can ‘pass along’ that trust to a service when it performs machine authentication.</p>
<p>Credentials used for machine authentication should be as tightly bound to the device as possible, using hardware protected storage (e.g. TPM). Private keys should be kept within the TPM and key attestation used, where possible.</p>
<h4><strong>Additional context, such as policy compliance and device health</strong></h4>
<p>Many authentication services can integrate with one or more&nbsp;mobile device management services&nbsp;to ensure that authenticating devices are compliant with corporate policy, before being allowed to access corporate data. This is typically implemented by issuing a short-lived certificate to devices which are compliant, and distributing the certificate using MDM. The certificate is then used for device authentication, implicitly asserting compliance.</p>
<p>Some authentication services are starting to include&nbsp;<i>device health attestation</i>&nbsp;as part of their compliance decision. This is a powerful technique which can be used to make strong assertions that a connecting device has booted securely and remains in a good state when accessing enterprise data. Device health attestation features should be enabled if they’re supported in your environment.</p>
<h4><strong>Authorisation policies to access an application</strong></h4>
<p>In the <i>traditional remote access architecture</i>, the presentation layer is used to restrict direct access to enterprise applications that should not be accessible to remote devices.</p>
<p>In the&nbsp;<i>zero trust network approach</i>, it is not possible to control network routing like this, so authorisation enforcement must be implemented elsewhere.&nbsp;Typically, this will be at the authentication point. This could achieved with a reverse proxy service in front of an enterprise application, or a single sign-on service, which issues tokens to access enterprise applications. In either case, the service would decline to authorise access to the application if the access request was not compliant with policy.</p>
<p>Authentication services might also require specific preconditions to be satisfied before access is granted to an enterprise application. For example, you can require multi-factor authentication for&nbsp;<i>some</i>&nbsp;of your enterprise applications but not others. Similarly, you may authorise out-of-date devices to access MDM, but not corporate email.</p>
<h4><strong>Access control policies within an application</strong></h4>
<p>Within an enterprise application, you may want to further control access to specific resources, using access control. Most services will allow you to grant access to specific authorised users, but a<i>&nbsp;zero trust network</i>&nbsp;approach also lets you incorporate more context into that access decision.</p>
<p>For example, you may wish to require multi-factor authentication before users can access sensitive corporate documents held in your file store. Meanwhile, single factor authorisation could be used for low security documents within the same file store. This might be beneficial in a&nbsp;<i>bring your own device</i>&nbsp;(BYOD) deployment, where personal devices may be allowed to access a subset of corporate data.</p>
<p>This model requires the authentication service to pass on details of the authorisation context to the enterprise application using technologies like <a href="https://en.wikipedia.org/wiki/Security_Assertion_Markup_Language">SAML</a><i>&nbsp;</i>or <a href="https://openid.net/connect/"><i>OpenID Connect</i></a>. This type of configuration is not currently widely implemented, so you should check what is supported with your authentication service and enterprise application provider.</p>
<h3><strong>How to set up a zero trust network</strong></h3>
<p>If you choose to develop a zero-trust architecture, keep in mind that:</p>
<ul>
  <li>Zero trust networking is relatively new and best practices are likely to evolve over time. It’s important to regularly revisit your approach to ensure that you’re taking advantage of the latest features and your policies are still effective.</li>
  <li>Your enterprise applications are now exposed beyond your perimeter. Each one of your internet-accessible services needs to be hardened against attack. You should follow&nbsp;best practices for deployments in the cloud, as well as ensuring that each service requires strong user and machine authentication.</li>
  <li>Implement&nbsp;strong user authentication, requiring multi-factor authentication for&nbsp;<i><strong>every&nbsp;</strong></i>exposed service, including management services. Consider using&nbsp;password-less authentication&nbsp;to mitigate attacks on your users’ passwords.</li>
  <li>Implement machine authentication, with credentials rooted in hardware, taking into account compliance and health attestation, if possible.</li>
  <li>Monitor logs&nbsp;from authentication services and enterprise applications.</li>
</ul>
<p>Where a full zero trust network approach cannot be adopted, implement the traditional remote access architecture and as many&nbsp;<i>zero trust networking</i>&nbsp;recommendations as possible</p>
