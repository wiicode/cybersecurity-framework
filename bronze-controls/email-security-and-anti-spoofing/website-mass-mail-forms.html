<!--
title: Guidance for websites, mass e-mail campaigns, and fax
description: 
published: true
date: 2021-07-13T18:28:07.512Z
tags: bronze, bronze-controls, email
editor: ckeditor
dateCreated: 2021-07-12T18:16:06.629Z
-->

<figure class="image image-style-align-right image_resized" style="width:38.93%;"><img src="/article_images/common-web-attacks.png"></figure>
<p>Major mail systems today, such as Exchange Online or Gmail, enforce a number of controls designed to thwart the spread of ransomware, reduce the chances of identity theft, minimize spear phishing, block malicious links, and filter out spam. Even in the most basic form, these systems can work against your organization's interest when it comes to collecting feedback / forms data from your digital marketing assets.&nbsp;</p>
<p>Feedback form transport is surprisingly complex because of the<strong> protection measures</strong> as well as the <strong>custodial responsibility</strong> of your organization over the data that may be submitted. &nbsp;The general strategy for any organization should be to:</p>
<ul>
  <li>Collect data that is material to objectives.</li>
  <li>Transport all data securely and protect the confidentiality of the information on arrival.</li>
  <li>Put organizational security (including MFA, Identity, and Conditional Access) ahead of feedback form concerns.</li>
  <li>Be able to audit every message transported and its delivery easily so that it is routine.</li>
</ul>
<h1>Review your posture.&nbsp;</h1>
<p>Before getting started, BCSF encourages to take stock of your feedback systems through the assessment below. &nbsp;Each statement represents a key component of an organization-wide implementation of feedback forms. In the least, a high number of “No” and “N/A” responses is indicative of problematic feedback form strategy.&nbsp;</p>
<h4>&nbsp;Assessment:</h4>
<figure class="table">
  <table>
    <tbody>
      <tr>
        <td><strong>Yes</strong></td>
        <td><strong>No</strong></td>
        <td><strong>N/A</strong></td>
        <td><strong>Statement</strong></td>
      </tr>
      <tr>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>Organization has valid SPF records with less than 10 lookups.&nbsp;</td>
      </tr>
      <tr>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>
          <p>Organization has a valid DMARC record meeting the following conditions</p>
          <ul>
            <li>DMARC policy must be at enforcement – either “p=quarantine” or “p=reject” on the organizational domain</li>
            <li>No&nbsp;sp=none or pct&lt;100</li>
          </ul>
        </td>
      </tr>
      <tr>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>Organization has a valid DKIM record. &nbsp;</td>
      </tr>
      <tr>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>Organization has a valid BIMI record.</td>
      </tr>
      <tr>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>Organization meets TLS 1.2 requirements and all support for “legacy” connections has been disabled.</td>
      </tr>
      <tr>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>Organization is able to enforce MFA/2FA authentication through conditional access.</td>
      </tr>
      <tr>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>Organization enforces MFA/2FA authentication globally (all mailboxes protected).</td>
      </tr>
      <tr>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>Organization website(s) publish e-mail addresses.</td>
      </tr>
      <tr>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>Organization website(s) use contact forms.</td>
      </tr>
      <tr>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>Organization website(s) force HTTPS and do not permit form submission using HTTP.</td>
      </tr>
      <tr>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>Organization website(s) are accessible.&nbsp;</td>
      </tr>
      <tr>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>Contact forms use the REPLY-TO parameter.</td>
      </tr>
      <tr>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>Contact forms use the FROM parameter.</td>
      </tr>
      <tr>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>Contact forms send a “thank you for your submission” email to requestor.</td>
      </tr>
      <tr>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>Contact forms include the <strong>form data</strong> in the requestor “thank-you” email including either the subject, comments, data or a combination of the three.&nbsp;</td>
      </tr>
      <tr>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>Contact forms offer flexible transport options and complete control over how a message with form data is sent.</td>
      </tr>
      <tr>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>Contact forms use the flexible transport options to send mail in a manner consistent with organizational policy.&nbsp;</td>
      </tr>
      <tr>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>Contact forms use a sub-domain or a third-party domain in the FROM parameter.</td>
      </tr>
      <tr>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>Contact forms use web-hooks or integrations to route data to other channels such as Slack, SalesForce, or Google Drive.&nbsp;</td>
      </tr>
      <tr>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>Organization uses a third-party form design and hosting service.</td>
      </tr>
      <tr>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>Organization uses a third-party transactional email service to transport form data.&nbsp;</td>
      </tr>
      <tr>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>Organization uses a mailbox to transport form data.</td>
      </tr>
      <tr>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>Organization uses a mailbox to transport data, whether it be one in their primary email platform or one supplied by a third party.</td>
      </tr>
      <tr>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>Organization has configured transport-level rules to white-list, permit, or otherwise modify delivery of inbound contact forms to ensure delivery.&nbsp;</td>
      </tr>
    </tbody>
  </table>
</figure>
<h4><br>Problem Statements:</h4>
<figure class="table">
  <table>
    <tbody>
      <tr>
        <td>Yes</td>
        <td>No</td>
        <td>N/A</td>
        <td>Statement</td>
      </tr>
      <tr>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>Form data is sent to <strong>Junk/Spam</strong> or not received.</td>
      </tr>
      <tr>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>Requestors do not receive “thank-you” emails.&nbsp;</td>
      </tr>
      <tr>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>Replies to contact forms by staff are unanswered by the requestor.</td>
      </tr>
    </tbody>
  </table>
</figure>
<h4><br>Activity Statements:</h4>
<figure class="table">
  <table>
    <tbody>
      <tr>
        <td>Yes</td>
        <td>No</td>
        <td>N/A</td>
        <td>Statement</td>
      </tr>
      <tr>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>Forms are routinely tested to verify functionality.</td>
      </tr>
      <tr>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>Form data is routinely reviewed.</td>
      </tr>
      <tr>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>Data handling controls are applied to form data.</td>
      </tr>
    </tbody>
  </table>
</figure>
<p>&nbsp;</p>
<h1>Understanding how e-mail through third-parties may flow.&nbsp;</h1>
<figure class="image image-style-align-right"><img src="/article_images/mailflow-diagram-webforms.png">
  <figcaption>Email Webform Flow Diagram</figcaption>
</figure>
<p>Most organizations today rely on Exchange or Google Workspace (or similar mail systems) to handle organizational email. &nbsp;These systems offer standard mail filtration in the basic plans, encourage adoption of DMARC/DKIM/SPF to ensure trust in email, encourage use of MFA to restrict mailbox access, and finally offer advanced tiers of security solutions for additional threat protections. &nbsp;</p>
<p>Web forms sending to these organizations must contend and adapt to all of those things to successfully deliver messages. &nbsp;While a contact form may seem simple, the lifecycle of the data inside the form - today - follows this general trend when designed correctly:</p>
<ul>
  <li>Feedback form securely accepts requestor data and builds the message.</li>
  <li>Messages are sent with full SPF compliance to the target recipients.&nbsp;</li>
  <li>Mail system receiving the message scans the message for threats and delivers the message to the target user or group.</li>
</ul>
<figure class="image image-style-align-right"><img src="/article_images/dkim-envelope-1.png"></figure>
<p>Each of these milestones has a series of much smaller, and much more important, steps and decision points. &nbsp;Collectively, their job is to ensure that the purported sender of the message is the person whose email address is in the <strong>FROM</strong> field of the message. &nbsp;Let's put that into an analogy we all may understand better.</p>
<figure class="image image-style-align-right"><img src="/article_images/dkim-letter-2.png"></figure>
<p>Suppose you have a letter mailed to you in an envelope from “B. Baz”. &nbsp;If it is an analog envelope and letter, you put some amount of trust that Baz did send the letter, but you also have a few things you can do to try to validate it. For instance, you can look at the cancelled stamp and make a decision as to whether or not the post office the letter moved through makes sense for the letter. &nbsp;If you use a service called “Informed Delivery” you could verify the message went through the Post Office and was not just shoved into your mailbox. &nbsp;If the letter was important, actions on behalf of the sender could have been implemented to help underscore the importance &nbsp;- such as registered mail, priority, and certified. &nbsp;While none of these things are foolproof, they add to the credibility of the message and influence your trust. &nbsp; In e-mail speak, this is effectively called a “spam score”.</p>
<p>Mail systems that leverage filters, SPF, DMARC, and DKIM do all these extra checks to attempt to verify that sender, the message transport services, and the recipient are all valid. &nbsp;If we continue along this analog mail analogy one could say that these systems:</p>
<ul>
  <li>Attempt to verify the sender on the envelope matches the signature in the message.</li>
  <li>Attempt to verify that the sender's address is real.</li>
  <li>Attempt to verify the recipient address is real.</li>
  <li>Attempt to verify that the content of the message is consistent with intent.</li>
</ul>
<p>Additionally, advanced threat protection will often:</p>
<ul>
  <li>Read the email and assess if the subject matter is applicable to business.</li>
  <li>Review relationships of the sender to recipient and attempt to determine if there is ample history or cause for the message to be routed.</li>
</ul>
<h1>Third-party email in real world practice.&nbsp;</h1>
<h2>Website Feedback Forms</h2>
<p>With all this validation it's no surprise that delivering a contact form from a web server to your mailbox can be daunting. &nbsp;Today,&nbsp;</p>
<ul>
  <li>The form must be able to properly set the FROM and the REPLY-TO e-mail addresses so the FROM always passes validation during transport.&nbsp;</li>
  <li>Construct the message in a way that does not cause spam filters to think it's junk.&nbsp;</li>
  <li>Transport the message through a valid mailbox, authorized SMTP server, or through a transactional email system.</li>
  <li>Do the same for a thank-you / confirmation email.</li>
</ul>
<p>Before talking about the first three points, the fourth one stands out on its own: &nbsp;the thank-you message is an exploitable asset. &nbsp;What typically happens is web-forms are analyzed by bots and malicious actors. If such bot can fill the form out with valid information, and then inject a malicious subject or comment, the thank-you message becomes a vector as it's content is now poisoned. &nbsp;This is why today's BCSF guidance strictly forbids the sending of form data inside confirmation messages to the senders on the form. &nbsp;The risk of spreading malicious content is simply too high.</p>
<h3>Successful strategy examples:</h3>
<h4>Transactional</h4>
<figure class="table">
  <table>
    <tbody>
      <tr>
        <td><strong>Yes</strong></td>
        <td><strong>No</strong></td>
        <td><strong>N/A</strong></td>
        <td><strong>Strategy</strong></td>
      </tr>
      <tr>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>Contact form forces HTTPS and securely transports data to recipients.</td>
      </tr>
      <tr>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>
          <p>Contact form has the ability use different</p>
          <ul>
            <li>FROM: &nbsp;uses an organization <strong>approved</strong> value such as “noreply@bentosecurity.org”.</li>
            <li>REPLY TO: &nbsp;uses the form submitter's email address</li>
            <li>and user/account if required during transport.&nbsp;</li>
          </ul>
        </td>
      </tr>
      <tr>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>Contact form integrates with transactional email senders such as SendGrid, MailGun, SparkPost, PostMark, etc and uses API to send the request.</td>
      </tr>
      <tr>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>No-Reply notification is sent to the submitter without form fields.&nbsp;</td>
      </tr>
    </tbody>
  </table>
</figure>
<h4>Dedicated SMTP</h4>
<figure class="table">
  <table>
    <tbody>
      <tr>
        <td><strong>Yes</strong></td>
        <td><strong>No</strong></td>
        <td><strong>N/A</strong></td>
        <td><strong>Strategy</strong></td>
      </tr>
      <tr>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>Contact form forces HTTPS and securely transports data to recipients.</td>
      </tr>
      <tr>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>
          <p>Contact form has the ability use different</p>
          <ul>
            <li>FROM: &nbsp;uses an organization <strong>approved</strong> value such as “noreply@bentosecurity.org”.</li>
            <li>REPLY TO: &nbsp;uses the form submitter's email address</li>
            <li>and user/account if required during transport.</li>
          </ul>
        </td>
      </tr>
      <tr>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>Contact form uses SMTP with TLS for SMTP server and authenticated username and password for the send. &nbsp;</td>
      </tr>
      <tr>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>Conditional access permits dedicated mailbox to authenticate without MFA.&nbsp;</td>
      </tr>
      <tr>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>Notification is sent to the submitter with a usable REPLY TO address but without form field data.</td>
      </tr>
    </tbody>
  </table>
</figure>
<h4>Web Hook / Integration</h4>
<figure class="table">
  <table>
    <tbody>
      <tr>
        <td><strong>Yes</strong></td>
        <td><strong>No</strong></td>
        <td><strong>N/A</strong></td>
        <td><strong>Strategy</strong></td>
      </tr>
      <tr>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>Contact form forces HTTPS and securely transports data to recipients.</td>
      </tr>
      <tr>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>
          <p>Contact form has the ability use different</p>
          <ul>
            <li>FROM: &nbsp;uses an organization <strong>approved</strong> value such as “noreply@bentosecurity.org”.</li>
            <li>REPLY TO: &nbsp;uses the form submitter's email address</li>
            <li>and user/account if required during transport.</li>
          </ul>
        </td>
      </tr>
      <tr>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>Native integration connects, and successfully authenticates, to a function that writes this form data to a com channel or web application.&nbsp;</td>
      </tr>
      <tr>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>The target application may have its own processor for sending notifications.&nbsp;</td>
      </tr>
    </tbody>
  </table>
</figure>
<h2>Support Systems and Automatic Replies</h2>
<p>Your support systems are also affected by e-mail protections. &nbsp;For example, if you use ZenDesk, you may have already realized that they implemented a programming change that prevented certain variables from working on the very first e-mail to avoid abuse. This affected all new tickets as follows:</p>
<ul>
  <li>When a new ticket is created, it is not possible to include the body of the request in the confirmation message</li>
  <li>When a new ticket is created, the subject of the message is not honored and the only option is to send a generic subjects such as “Request Received.”</li>
</ul>
<p>Support systems and CRM should:</p>
<figure class="table">
  <table>
    <tbody>
      <tr>
        <td><strong>Yes</strong></td>
        <td><strong>No</strong></td>
        <td><strong>N/A</strong></td>
        <td><strong>Strategy</strong></td>
      </tr>
      <tr>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>Be authorized to send on your organization's behalf using SPF, DMARC, and DKIM.&nbsp;</td>
      </tr>
      <tr>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>Triggers/Macros that send the “thank you” message should be generic and include none of the submission. &nbsp;</td>
      </tr>
      <tr>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>Procedures must be in place to effectively create tickets on the behalf of customers which bear in mind the lack of detail in the initial message.&nbsp;</td>
      </tr>
    </tbody>
  </table>
</figure>
<p>&nbsp;</p>
<h2>E-Mail Marketing</h2>
<p>E-mail marketing is most often sent with your organization's domain in the FROM field. &nbsp;All reputable mass mailing systems include detailed guidance on authorizing their systems to send on your behalf. &nbsp;Here is a sample:</p>
<ul>
  <li>MailChimp SPF &amp; DKIM: <a href="https://mailchimp.com/help/set-up-email-domain-authentication/">https://mailchimp.com/help/set-up-email-domain-authentication/</a></li>
  <li>ConstantContact:<ul>
      <li>DKIM: <a href="https://knowledgebase.constantcontact.com/articles/KnowledgeBase/39520-Set-Up-the-Self-Authentication-DKIM-Key-with-Your-Hosting-Provider?q=DKIM&amp;pnx=1&amp;lang=en_US">https://knowledgebase.constantcontact.com/articles/KnowledgeBase/39520-Set-Up-the-Self-Authentication-DKIM-Key-with-Your-Hosting-Provider?q=DKIM&amp;pnx=1&amp;lang=en_US</a></li>
      <li>SPF: <a href="https://knowledgebase.constantcontact.com/articles/KnowledgeBase/34717-SPF-Self-Publishing-for-Email-Authentication?lang=en_US">https://knowledgebase.constantcontact.com/articles/KnowledgeBase/34717-SPF-Self-Publishing-for-Email-Authentication?lang=en_US</a></li>
    </ul>
  </li>
</ul>
