<!--
title: Macro Security for Microsoft Office
description: Why macros are a threat, and the approaches you can take to protect your systems.
published: true
date: 2021-06-02T13:28:42.279Z
tags: guidance, bronze, bronze-controls
editor: ckeditor
dateCreated: 2021-06-02T13:28:42.279Z
-->

<p>This guidance describes how administrators can help protect their systems from malicious Microsoft Office macros. It outlines why macros are a threat, and the approaches you can take to protect your devices.</p>
<h2>What are macros, and why are they a problem?</h2>
<p>A macro is a small program that is often written to automate repetitive tasks in Microsoft Office applications. Macros have been historically used for a variety of reasons - from an individual automating part of their job, to organisations building entire processes and data flows. Macros are written in Visual Basic for Applications (VBA) and are saved as part of the Office file.</p>
<p>Macros are often created for legitimate reasons, but they can also be written by attackers to gain access to or harm a system, or to bypass <a href="https://www.ncsc.gov.uk/collection/end-user-device-security">other security controls</a> such as application allow listing. In fact, exploitation from malicious macros&nbsp;<a href="https://cofense.com/microsoft-office-macros-still-leader-malware-delivery/">is one of the top ways that organisations around the world are compromised today</a>. Malicious macros can do almost anything that other malware can do to your system, including emulating ransomware, stealing data, and emailing itself out to your contacts.</p>
<p>Malicious macros are not new; the underlying attack has remained unchanged since the 1990s, and they still form the majority of attacks targeting Microsoft Office. However, obfuscation and dynamic content loading has made malicious documents more difficult for traditional antivirus to detect.</p>
<p>Macros are often part of phishing or spear phishing campaigns. In this, an attacker sends emails and attempts to convince the user to open the attached file and run the malicious macro. Techniques (such as <a href="https://twitter.com/JohnLaTwC/status/775689864389931008">these seen by Microsoft</a>) successfully use social engineering to trick well-intentioned users into enabling malicious Office macros. The <a href="https://www.ncsc.gov.uk/guidance/phishing"><i>NCSC</i> phishing guidance</a> discusses how you can defend your<i> organisation </i>against phishing attacks.</p>
<hr>
<h2>Protecting your systems from malicious macros</h2>
<p>The only effective way to protect your systems against malicious macros is to disable macros across Office apps, and ensure users cannot re-enable them.</p>
<p>Many organisations currently rely on Office macros for day-to-day business functions, including where they’re used to interact with external partners. Organisations that are still using macros should develop a strategy for replacing them - we've included a few tips below for <a href="https://www.ncsc.gov.uk/guidance/macro-security-for-microsoft-office#reduce">how you might do this</a>.</p>
<p>If you can’t yet turn macros off, you will need to find the combination of mitigations listed below that are most effective for you, as different organisations use macros in different ways. That said, for <strong>all</strong> installations of Microsoft Office you should:</p>
<ul>
  <li>disable Office macros except in the <a href="https://docs.microsoft.com/en-gb/DeployOffice/plan-office-365-proplus#step-3---choose-your-update-channels">specific</a> apps where they are required</li>
  <li>only enable macros for staff that rely on them every day</li>
  <li>use an anti-malware product that integrates with the <a href="https://docs.microsoft.com/en-us/windows/win32/amsi/antimalware-scan-interface-portal">Anti Malware Scan Interface (AMSI)</a> on Windows 10</li>
  <li>use the latest version of Office (<a href="https://docs.microsoft.com/en-gb/DeployOffice/plan-office-365-proplus#step-3---choose-your-update-channels">ideally the Monthly Channel</a>) on the latest version of the platform</li>
</ul>
<h4><strong>Tip 1.&nbsp;Disable macros where they're not used</strong></h4>
<p>If your<i> organisation </i>does not use macros, they should be turned off entirely. If you cannot yet turn macros off, you should work on replacing the macros that your business relies on, so that you can turn them off entirely in the future. Larger organisations should consider only enabling macros for the specific groups or teams that need them. This allows training to be better-focused and appropriately targeted for these smaller sets of users, to help them understand social engineering techniques and agree sensible protective measures.</p>
<p>The cloud-based <a href="https://docs.microsoft.com/en-us/deployoffice/overview-of-security-policy-advisor">Security Policy Advisor</a> can help you identify groups that can have macros disabled with minimal impact, and optionally integrate with <a href="https://docs.microsoft.com/en-gb/microsoft-365/security/office-365-security/office-365-ti">Office 365 ATP</a> to identify the top users of macros, and the top users who are targeted by documents with malicious macros. The service relies on telemetry sent to Microsoft from your devices. You will need to be comfortable with at least <a href="https://docs.microsoft.com/en-gb/deployoffice/privacy/required-service-data">required service data</a> being collected by Microsoft and ensure that those data flows are enabled. If&nbsp;diagnostic&nbsp;telemetry is enabled, we recommend disabling the additional <a href="https://docs.microsoft.com/en-us/deployoffice/privacy/optional-diagnostic-data">optional diagnostic data</a>.</p>
<p>You should note that:</p>
<ul>
  <li>Recent versions of Microsoft Office have macros <strong>enabled by default</strong>, but rely on the user to click a button before any macros can run. It is relatively simple to trick the user into clicking this button, so you cannot rely on it as a mitigation.</li>
  <li><strong>Macros on Windows</strong> are configured per-application. If you use macros in some Office applications and not others, you should disable them in the applications where they are not used. For example, if your<i> organisation </i>only uses macros in Excel, you can disable them in Word, PowerPoint, Visio, Access and Publisher. Note that OneNote does not support macros.</li>
  <li><strong>Macros on macOS</strong> are configured for the entire Office suite so you should aim to entirely disable them.</li>
</ul>
<h4><strong>Tip 2. Reduce your dependency on macros</strong></h4>
<p>If you cannot turn off macros because you currently use them, you should work to reduce your dependency on them. You should<i> prioritise </i>replacing macros that are incompatible with the <a href="https://docs.microsoft.com/en-us/windows/security/threat-protection/microsoft-defender-atp/attack-surface-reduction">attack surface reduction (ASR) rules</a> listed below. Recent alternatives to office automation that can replace macros include:</p>
<ul>
  <li>using off-the-shelf <a href="https://docs.microsoft.com/en-us/office/dev/add-ins/overview/office-add-ins">Office Add-ins</a> to add new functionality to Office applications</li>
  <li>automating data flows using modern SaaS alternatives such as <a href="https://support.office.com/en-gb/forms">Forms</a>, <a href="https://powerapps.microsoft.com/en-us/automate-processes/">Flow</a> and <a href="https://powerapps.microsoft.com/en-us/">PowerApps</a></li>
  <li>building custom Web Applications that support business processes</li>
  <li>building on off-the-shelf serverless cloud components</li>
</ul>
<h4><strong>Tip 3. Disable high-risk macro capabilities</strong></h4>
<p>Exploit Guard <a href="https://docs.microsoft.com/en-us/windows/security/threat-protection/microsoft-defender-atp/attack-surface-reduction">attack surface reduction (ASR) rules</a> on Windows 10 can be configured to disable some of the abilities of malicious macros. Exploit Guard can be initially <a href="https://docs.microsoft.com/en-us/windows/security/threat-protection/microsoft-defender-atp/audit-windows-defender">run in audit mode</a> to allow you to confirm that the macros that your<i> organisation </i>uses will continue to work properly. ASR rules also affect the<i> behaviour </i>of other Office features (such as Add-ins), so will require testing prior to broad deployment in organisations that rely on third party Office plugins.</p>
<p>Office on macOS uses the platform’s sandbox to limit the damage caused by a malicious document. We recommend <a href="https://docs.microsoft.com/en-us/deployoffice/mac/deploy-preferences-for-office-for-mac">strengthening the default configuration of the Office sandbox</a> to further reduce the impact of running malicious macros.</p>
<h4><strong>Tip 4. Use an antimalware product to detect malicious</strong><i><strong> behaviour </strong></i><strong>in macros</strong></h4>
<p>You can reduce the chance of a malicious macro reaching a user if you use an anti-malware product that includes behavioural analysis for macro-enabled Office documents. It could be a part of your email service, or a feature of the anti-malware software on the user’s device.</p>
<p>Organisations using an antivirus that uses <a href="https://docs.microsoft.com/en-us/windows/win32/amsi/antimalware-scan-interface-portal">Microsoft’s AMSI interface</a> (as recommended in the <i>NCSC</i>'s&nbsp;<a href="https://www.ncsc.gov.uk/collection/end-user-device-security/platform-specific-guidance/eud-security-guidance-windows-10-1809">EUD Guidance for Windows 10</a>) can detect malicious macros even if the malicious intent is cleverly disguised. You should configure the feature to <strong>scan all documents</strong>, as the default is to only scan those that Office has identified as having come from the Internet.</p>
<figure class="image image_resized" style="width:auto;"><img src="https://www.ncsc.gov.uk/static-assets/images/guidance/malicious%20behaviour.png"></figure>
<p>We recommend that devices connected to the Internet are configured in line with the <i>NCSC</i>’s <a href="https://www.ncsc.gov.uk/collection/end-user-device-security">End User Devices Security Guidance</a>. While application allow listing is unlikely to prevent malicious macros themselves from running, a configuration such as the one suggested in the guidance for <a href="https://www.ncsc.gov.uk/collection/end-user-device-security/platform-specific-guidance/eud-security-guidance-windows-10-1809">Windows 10</a> and <a href="https://www.ncsc.gov.uk/collection/end-user-device-security/platform-specific-guidance/macos-10-14">macOS</a> is often effective in blocking malware that is downloaded/extracted from the macro.</p>
<h4><strong>Tip 5. Disable macros unless they are in trusted files</strong></h4>
<p>Organisations that have a code signing service can choose to configure Office on Windows to only allow digitally signed macros to run. This is lower risk than allowing an Office application to open any macro, as malicious macros are not usually signed by their authors.</p>
<p>Office on Windows can also be configured to only allow macros if the file is loaded from a trusted location, such as a specific folder, file share or website. Your<i> organisation </i>will need to define that list of trusted locations. We recommend that macros are only permitted to run from a trusted location, such as a network share that only trusted administrators have write access to.</p>
<p>The antivirus integration described above does not apply to macros in trusted files by default, as many organisations rely on macros that exhibit similar behaviours to malware.</p>
<h4><strong>Tip 6. Block macros from the Internet</strong></h4>
<p>Office 2016 on Windows introduced the ability for an<i> organisation </i>to <a href="https://blogs.technet.microsoft.com/mmpc/2016/03/22/new-feature-in-office-2016-can-block-macros-and-help-prevent-infection/">block macros in files received from the Internet</a>. This makes it more difficult to trick the user into bypassing the warning. Macros are blocked from the Internet by default on <a href="https://www.microsoft.com/en-gb/windows/s-mode">Windows 10 in S mode</a>. This feature is <strong>not</strong> available on macOS.</p>
<figure class="image image_resized" style="width:auto;"><img src="https://www.ncsc.gov.uk/static-assets/images/guidance/block%20from%20interwebs.png"></figure>
<p>Note that it is usually <strong>not</strong> practical to block the file types that can contain macros as they can be found in commonly used legacy formats (such as .RTF .DOC and .DOT), as well as the newer formats that explicitly mark themselves as containing a macro (such as .DOCM and .DOTM).</p>
<hr>
<h2>Configuration options for Windows devices managed by the cloud</h2>
<p>Most of the mitigation options above can be configured using the <a href="https://docs.microsoft.com/en-us/deployoffice/overview-office-cloud-policy-service">Office Cloud Policy Service</a> (OCPS) for users that have signed into their Office applications using their work identity. This includes devices that are joined to Azure Active Directory. Some settings apply to Windows rather than Office, and can be configured via MDM.</p>
<p>Some settings can be applied separately for each Office application that you have installed. Organisations using OCPS can apply Office settings to different groups of users, allowing macros to be enabled for a specific subset of the people in your <i>organisation</i>.</p>
<p>The service implements a subset of the user-based policies that are available in group policy. Microsoft publishes <a href="https://technet.microsoft.com/en-us/library/ee857085%28v=office.16%29.aspx">documentation explaining the group policy settings</a> available for Office 365 ProPlus, Office 2016, and Office 2019.</p>
<h3><strong>Configuration to disable the Office macro engine</strong></h3>
<p>You can set a policy to disable macros across all Office applications:</p>
<figure class="table" style="width:635px;">
  <table style="background-color:rgb(255, 255, 255);border-bottom:0px;border-left:0px;border-right:0px;border-top:0px;">
    <thead>
      <tr>
        <th style="border-bottom:3px solid rgb(5, 28, 72);border-left:0px;border-right:0px;border-top:0px !important;padding:0px 0px 16px;width:113px;"><strong>OCPS policy</strong></th>
        <th style="border-bottom:3px solid rgb(5, 28, 72);border-left:0px;border-right:0px;border-top:0px !important;padding:0px 0px 16px 30px;width:261px;"><strong>Application</strong></th>
        <th style="border-bottom:3px solid rgb(5, 28, 72);border-left:0px;border-right:0px;border-top:0px !important;padding:0px 0px 16px 30px;"><strong>Configuration</strong></th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:0px;">Disable VBA for Office applications</td>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:16px 0px 0px 30px;">Office</td>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:16px 0px 0px 30px;">True</td>
      </tr>
    </tbody>
  </table>
</figure>
<p>&nbsp;</p>
<p>If you choose to leave macros enabled for some applications, you should set the policies to disable them for the other Office applications. You should also configure the recommended security mitigations in the following section (this is not necessary if you disable macros for all applications using the configuration below).</p>
<figure class="table" style="width:635px;">
  <table style="background-color:rgb(255, 255, 255);border-bottom:0px;border-left:0px;border-right:0px;border-top:0px;">
    <thead>
      <tr>
        <th style="border-bottom:3px solid rgb(5, 28, 72);border-left:0px;border-right:0px;border-top:0px !important;padding:0px 0px 16px;width:113px;"><strong>OCPS policy</strong></th>
        <th style="border-bottom:3px solid rgb(5, 28, 72);border-left:0px;border-right:0px;border-top:0px !important;padding:0px 0px 16px 30px;width:261px;"><strong>Application</strong></th>
        <th style="border-bottom:3px solid rgb(5, 28, 72);border-left:0px;border-right:0px;border-top:0px !important;padding:0px 0px 16px 30px;"><strong>Configuration</strong></th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:0px 0px 16px;">
          <p>For each of Access, Excel, PowerPoint, Publisher, Project, Visio and Word:</p>
          <p>&nbsp;</p>
          <p>VBA Macro Notification Settings</p>
          <p>&nbsp;&nbsp;</p>
        </td>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:16px 0px 16px 30px;">[Application name]</td>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:16px 0px 16px 30px;">Disable all without notification</td>
      </tr>
      <tr>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:0px;">Security settings for macros</td>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:16px 0px 0px 30px;">Outlook</td>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:16px 0px 0px 30px;">Never warn, disable all</td>
      </tr>
    </tbody>
  </table>
</figure>
<p>&nbsp;</p>
<h3><strong>Configuration to only allow digitally signed macros</strong></h3>
<p>You will need to set a group policy for each Office application that you want to configure. We suggest also configuring the recommended security mitigations in the following section, even if you only allow digitally signed macros across the Office suite.</p>
<figure class="table" style="width:635px;">
  <table style="background-color:rgb(255, 255, 255);border-bottom:0px;border-left:0px;border-right:0px;border-top:0px;">
    <thead>
      <tr>
        <th style="border-bottom:3px solid rgb(5, 28, 72);border-left:0px;border-right:0px;border-top:0px !important;padding:0px 0px 16px;width:113px;"><strong>OCPS policy</strong></th>
        <th style="border-bottom:3px solid rgb(5, 28, 72);border-left:0px;border-right:0px;border-top:0px !important;padding:0px 0px 16px 30px;width:261px;"><strong>Application</strong></th>
        <th style="border-bottom:3px solid rgb(5, 28, 72);border-left:0px;border-right:0px;border-top:0px !important;padding:0px 0px 16px 30px;"><strong>Configuration</strong></th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:0px 0px 16px;">
          <p>For each of Access, Excel, PowerPoint, Publisher, Project, Visio and Word:</p>
          <p>&nbsp;</p>
          <p>VBA Macro Notification Settings</p>
          <p>&nbsp;&nbsp;</p>
        </td>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:16px 0px 16px 30px;">[Application name]</td>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:16px 0px 16px 30px;">Disable all without notification</td>
      </tr>
      <tr>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:0px;">Security settings for macros</td>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:16px 0px 0px 30px;">Outlook</td>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:16px 0px 0px 30px;">Warn for signed, disable unsigned</td>
      </tr>
    </tbody>
  </table>
</figure>
<p>&nbsp;</p>
<h3><strong>Configuration to enable recommended macro security mitigations</strong></h3>
<p>These settings are recommended for all Office deployments that allow any use of macros.</p>
<figure class="table" style="width:635px;">
  <table style="background-color:rgb(255, 255, 255);border-bottom:0px;border-left:0px;border-right:0px;border-top:0px;">
    <thead>
      <tr>
        <th style="border-bottom:3px solid rgb(5, 28, 72);border-left:0px;border-right:0px;border-top:0px !important;padding:0px 0px 16px;width:113px;"><strong>OCPS policy</strong></th>
        <th style="border-bottom:3px solid rgb(5, 28, 72);border-left:0px;border-right:0px;border-top:0px !important;padding:0px 0px 16px 30px;width:261px;"><strong>Application</strong></th>
        <th style="border-bottom:3px solid rgb(5, 28, 72);border-left:0px;border-right:0px;border-top:0px !important;padding:0px 0px 16px 30px;"><strong>Configuration</strong></th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:0px 0px 16px;">Macro runtime scan scope</td>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:16px 0px 16px 30px;">Office</td>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:16px 0px 16px 30px;">Enable for all documents</td>
      </tr>
      <tr>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:0px;">
          <p>For each of Access, Excel, PowerPoint, Visio and Word:</p>
          <p>Block macros from running in Office files that come from the Internet</p>
        </td>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:16px 0px 0px 30px;">[Application Name]</td>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:16px 0px 0px 30px;">True</td>
      </tr>
    </tbody>
  </table>
</figure>
<h3>&nbsp;</h3>
<figure class="table" style="width:635px;">
  <table style="background-color:rgb(255, 255, 255);border-bottom:0px;border-left:0px;border-right:0px;border-top:0px;">
    <thead>
      <tr>
        <th style="border-bottom:3px solid rgb(5, 28, 72);border-left:0px;border-right:0px;border-top:0px !important;padding:0px 0px 16px;width:113px;"><strong>MDM Device Configuration Profile</strong></th>
        <th style="border-bottom:3px solid rgb(5, 28, 72);border-left:0px;border-right:0px;border-top:0px !important;padding:0px 0px 16px 30px;width:261px;"><strong>Configuration</strong></th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:0px 0px 16px;">Endpoint protection – Windows Defender Exploit Guard – Attack Surface Reduction Attack Surface Reduction Office apps launching child processes</td>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:16px 0px 16px 30px;">
          <p>Block</p>
          <p>&nbsp;</p>
        </td>
      </tr>
      <tr>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:0px 0px 16px;">Endpoint protection – Windows Defender Exploit Guard – Attack Surface Reduction Office apps/macros creating executable content</td>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:16px 0px 16px 30px;">Block</td>
      </tr>
      <tr>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:0px 0px 16px;">Endpoint protection – Windows Defender Exploit Guard – Attack Surface Reduction Office apps injecting into other processes (no exceptions)</td>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:16px 0px 16px 30px;">Block</td>
      </tr>
      <tr>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:0px 0px 16px;">Endpoint protection – Windows Defender Exploit Guard – Attack Surface Reduction Win32 imports from Office macro code</td>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:16px 0px 16px 30px;">Block</td>
      </tr>
      <tr>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:0px;">Endpoint protection – Windows Defender Exploit Guard – Attack Surface Reduction Execution of executable content (exe, dll, ps, js, vbs, etc.) dropped from email (webmail/mail client) (no exceptions)</td>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:16px 0px 0px 30px;">Block</td>
      </tr>
    </tbody>
  </table>
</figure>
<h3>&nbsp;</h3>
<h3><strong>Configuration to&nbsp;limit service data sent to Microsoft</strong></h3>
<p>If your<i> organisation </i>is using the Security Policy Advisor, you will need to configure Office to allow&nbsp;just&nbsp;the required&nbsp;service&nbsp;data to be collected:</p>
<figure class="table" style="width:635px;">
  <table style="background-color:rgb(255, 255, 255);border-bottom:0px;border-left:0px;border-right:0px;border-top:0px;">
    <thead>
      <tr>
        <th style="border-bottom:3px solid rgb(5, 28, 72);border-left:0px;border-right:0px;border-top:0px !important;padding:0px 0px 16px;width:113px;"><strong>OCPS policy</strong></th>
        <th style="border-bottom:3px solid rgb(5, 28, 72);border-left:0px;border-right:0px;border-top:0px !important;padding:0px 0px 16px 30px;width:261px;"><strong>Application</strong></th>
        <th style="border-bottom:3px solid rgb(5, 28, 72);border-left:0px;border-right:0px;border-top:0px !important;padding:0px 0px 16px 30px;"><strong>Configuration</strong></th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:0px;">Allow the use of connected experiences in Office&nbsp; &nbsp;&nbsp;</td>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:16px 0px 0px 30px;">Office</td>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:16px 0px 0px 30px;">Enabled</td>
      </tr>
    </tbody>
  </table>
</figure>
<p>&nbsp;</p>
<p>You can&nbsp;optionally also&nbsp;prevent diagnostic data from&nbsp;being sent to Microsoft:</p>
<figure class="table" style="width:635px;">
  <table style="background-color:rgb(255, 255, 255);border-bottom:0px;border-left:0px;border-right:0px;border-top:0px;">
    <thead>
      <tr>
        <th style="border-bottom:3px solid rgb(5, 28, 72);border-left:0px;border-right:0px;border-top:0px !important;padding:0px 0px 16px;width:113px;"><strong>OCPS policy</strong></th>
        <th style="border-bottom:3px solid rgb(5, 28, 72);border-left:0px;border-right:0px;border-top:0px !important;padding:0px 0px 16px 30px;width:261px;"><strong>Application</strong></th>
        <th style="border-bottom:3px solid rgb(5, 28, 72);border-left:0px;border-right:0px;border-top:0px !important;padding:0px 0px 16px 30px;"><strong>Configuration</strong></th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:0px;">Configure the level of diagnostic data sent by Office to Microsoft&nbsp; &nbsp;&nbsp;</td>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:16px 0px 0px 30px;">Office</td>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:16px 0px 0px 30px;">Neither</td>
      </tr>
    </tbody>
  </table>
</figure>
<hr>
<h2>Configuration options for Windows devices managed by Group Policy</h2>
<p>Most of the mitigation options above can be configured using Group Policy across an enterprise, or Local Group Policy on an individual machine.</p>
<p>Some settings will need to be configured separately for each Office application that you have installed on devices. Enterprises using Active Directory can apply group policies to different Organizational Units, allowing macros to be enabled for a specific subset of the people in your <i>organisation</i>.</p>
<ul>
  <li>Microsoft publishes&nbsp;<a href="https://technet.microsoft.com/en-us/library/ee857085%28v=office.16%29.aspx">documentation explaining the group policy settings</a>&nbsp;available for&nbsp;Office 2016, Office 365 ProPlus and Office 2019.</li>
  <li>Microsoft also publishes a&nbsp;<a href="https://blogs.technet.microsoft.com/secguide/2018/02/13/security-baseline-for-office-2016-and-office-365-proplus-apps-final/">security baseline for Office 2016 and Office 365 ProPlus</a>. Their baseline includes their recommended security settings for the whole of the Office suite on Windows, including some of the settings recommended by this guidance.</li>
  <li>You may need to&nbsp;<a href="https://www.microsoft.com/en-us/download/details.aspx?id=49030">install the Administrative Template Pack</a>&nbsp;for Office 365 ProPlus, Office 2019 and Office 2016 to be able to configure the Group Policies below.</li>
</ul>
<p>&nbsp;</p>
<h3><strong>Configuration to disable the Office macro engine</strong></h3>
<p>You can set a policy to disable macros across all Office applications:</p>
<figure class="table" style="width:635px;">
  <table style="background-color:rgb(255, 255, 255);border-bottom:0px;border-left:0px;border-right:0px;border-top:0px;">
    <thead>
      <tr>
        <th style="border-bottom:3px solid rgb(5, 28, 72);border-left:0px;border-right:0px;border-top:0px !important;padding:0px 0px 16px;width:113px;"><strong>Group policy</strong></th>
        <th style="border-bottom:3px solid rgb(5, 28, 72);border-left:0px;border-right:0px;border-top:0px !important;padding:0px 0px 16px 30px;width:261px;"><strong>Value</strong></th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:0px;">User Configuration &gt; Administrative Templates &gt; Microsoft&nbsp;Office&nbsp;2016 &gt; [<i>Application name</i>] Settings &gt; Security&nbsp;Disable VBA for Office applications</td>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:16px 0px 0px 30px;">Enable</td>
      </tr>
    </tbody>
  </table>
</figure>
<p>&nbsp;</p>
<p>If you choose to leave macros enabled for some applications, you should set the policies to disable them for the other Office applications.&nbsp;You should also configure the recommended security mitigations in the following section&nbsp;(this is not necessary if you disable macros for all&nbsp;Office&nbsp;applications):</p>
<figure class="table" style="width:635px;">
  <table style="background-color:rgb(255, 255, 255);border-bottom:0px;border-left:0px;border-right:0px;border-top:0px;">
    <thead>
      <tr>
        <th style="border-bottom:3px solid rgb(5, 28, 72);border-left:0px;border-right:0px;border-top:0px !important;padding:0px 0px 16px;width:113px;"><strong>Group policy</strong></th>
        <th style="border-bottom:3px solid rgb(5, 28, 72);border-left:0px;border-right:0px;border-top:0px !important;padding:0px 0px 16px 30px;width:261px;"><strong>Value</strong></th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:0px 0px 16px;">
          <p>For each of Access, Excel, PowerPoint, Project, Visio and Word:</p>
          <p>&nbsp;</p>
          <p>User Configuration &gt; Administrative Templates &gt; Microsoft [<i>Application name</i>] 2016 &gt; [<i>Application name</i>] Settings &gt; Security &gt; Trust Center &gt; VBA Macro Notification Settings</p>
        </td>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:16px 0px 16px 30px;">
          <p>Enabled</p>
          <p>Disable all without notifcation</p>
          <p>&nbsp;</p>
        </td>
      </tr>
      <tr>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:0px 0px 16px;">
          <p>For&nbsp;Access:</p>
          <p>&nbsp;</p>
          <p>User Configuration &gt; Administrative Templates &gt; Microsoft&nbsp;Access&nbsp;2016 &gt;&nbsp;Application Settings &gt;&nbsp;Security &gt; Trust Center &gt; VBA Macro Notification Settings</p>
        </td>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:16px 0px 16px 30px;">
          <p>Enabled</p>
          <p>Disable all without notifcation</p>
        </td>
      </tr>
      <tr>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:0px 0px 16px;">
          <p>For&nbsp;Outlook:</p>
          <p>&nbsp;</p>
          <p>User Configuration &gt; Administrative Templates &gt; Microsoft&nbsp;Access&nbsp;2016 &gt; Security &gt; Trust Center &gt;&nbsp;Security settings for macros</p>
        </td>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:16px 0px 16px 30px;">Warn for signed, disable unsigned</td>
      </tr>
      <tr>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:0px;">
          <p>For Publisher:</p>
          <p>&nbsp;</p>
          <p>User Configuration &gt; Administrative Templates &gt; Microsoft&nbsp;Publisher&nbsp;2016 &gt; Security &gt; Trust Center &gt; VBA Macro Notification Settings</p>
        </td>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:16px 0px 0px 30px;">
          <p>Enabled</p>
          <p>Disable all&nbsp;without notification</p>
        </td>
      </tr>
    </tbody>
  </table>
</figure>
<p>&nbsp;</p>
<h3><strong>Configuration to only allow digitally signed macros</strong></h3>
<p>You will need to set a group policy for each Office application that you want to configure. We suggest also configuring the recommended security mitigations in the following section, even if you only allow digitally signed macros across the Office suite.</p>
<figure class="table" style="width:635px;">
  <table style="background-color:rgb(255, 255, 255);border-bottom:0px;border-left:0px;border-right:0px;border-top:0px;">
    <thead>
      <tr>
        <th style="border-bottom:3px solid rgb(5, 28, 72);border-left:0px;border-right:0px;border-top:0px !important;padding:0px 0px 16px;width:113px;"><strong>Group policy</strong></th>
        <th style="border-bottom:3px solid rgb(5, 28, 72);border-left:0px;border-right:0px;border-top:0px !important;padding:0px 0px 16px 30px;width:261px;"><strong>Value</strong></th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:0px 0px 16px;">
          <p>For each of Access, Excel, PowerPoint, Project, Visio and Word:</p>
          <p>&nbsp;</p>
          <p>User Configuration &gt; Administrative Templates &gt; Microsoft [<i>Application name</i>] 2016 &gt; [<i>Application name</i>] Settings &gt; Security &gt; Trust Center &gt; VBA Macro Notification Settings</p>
        </td>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:16px 0px 16px 30px;">
          <p>Enabled</p>
          <p>Disable all except digitally signed macros</p>
          <p>&nbsp;</p>
        </td>
      </tr>
      <tr>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:0px 0px 16px;">
          <p>For&nbsp;Access:</p>
          <p>&nbsp;</p>
          <p>User Configuration &gt; Administrative Templates &gt; Microsoft&nbsp;Access&nbsp;2016 &gt;&nbsp;Application Settings &gt;&nbsp;Security &gt; Trust Center &gt; VBA Macro Notification Settings</p>
        </td>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:16px 0px 16px 30px;">
          <p>Enabled</p>
          <p>Disable all except digitally signed macros</p>
        </td>
      </tr>
      <tr>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:0px 0px 16px;">
          <p>For&nbsp;Outlook:</p>
          <p>&nbsp;</p>
          <p>User Configuration &gt; Administrative Templates &gt; Microsoft&nbsp;Access&nbsp;2016 &gt; Security &gt; Trust Center &gt;&nbsp;Security settings for macros</p>
        </td>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:16px 0px 16px 30px;">Never warn, disable all</td>
      </tr>
      <tr>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:0px;">
          <p>For Publisher:</p>
          <p>&nbsp;</p>
          <p>User Configuration &gt; Administrative Templates &gt; Microsoft&nbsp;Publisher&nbsp;2016 &gt; Security &gt; Trust Center &gt; VBA Macro Notification Settings</p>
        </td>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:16px 0px 0px 30px;">
          <p>Enabled</p>
          <p>Disable all except digitally signed macros</p>
        </td>
      </tr>
    </tbody>
  </table>
</figure>
<p>&nbsp;</p>
<h3><strong>Configuration to enable recommended macro security mitigations</strong></h3>
<p>These settings are recommended for all Office deployments that allow any use of macros.</p>
<figure class="table" style="width:635px;">
  <table style="background-color:rgb(255, 255, 255);border-bottom:0px;border-left:0px;border-right:0px;border-top:0px;">
    <thead>
      <tr>
        <th style="border-bottom:3px solid rgb(5, 28, 72);border-left:0px;border-right:0px;border-top:0px !important;padding:0px 0px 16px;width:113px;"><strong>Group policy</strong></th>
        <th style="border-bottom:3px solid rgb(5, 28, 72);border-left:0px;border-right:0px;border-top:0px !important;padding:0px 0px 16px 30px;width:261px;"><strong>Value</strong></th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:0px 0px 16px;">Compute Configuration &gt; Windows components &gt; Windows Defender Antivirus &gt; Windows Defender Exploit Guard &gt; Attack surface reduction &gt; Configure Attack surface reduction rules</td>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:16px 0px 16px 30px;">
          <p>Enabled</p>
          <p>&nbsp;</p>
          <p>D4F940AB-401B-4EFC-AADC-AD5F3C50688A = 1</p>
          <p>&nbsp;</p>
          <p>3B576869-A4EC-4529-8536-B80A7769E899 = 1</p>
          <p>&nbsp;</p>
          <p>75668C1F-73B5-4CF0-BB93-3ECF5CB7CC84 = 1</p>
          <p>&nbsp;</p>
          <p>92E97FA1-2EDF-4476-BDD6-9DD0B4DDDC7B = 1</p>
          <p>&nbsp;</p>
          <p>BE9BA2D9-53EA-4CDC-84E5-9B1EEEE46550 =&nbsp;1</p>
        </td>
      </tr>
      <tr>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:0px 0px 16px;">User Configuration &gt; Administrative templates &gt; Microsoft Office 2016 &gt; Security Settings &gt; Macro Runtime Scan Scope</td>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:16px 0px 16px 30px;">Enable for all documents</td>
      </tr>
      <tr>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:0px 0px 16px;">
          <p>For each of Excel, PowerPoint, Project, Visio and Word:</p>
          <p>&nbsp;</p>
          <p>User Configuration &gt; Administrative Templates &gt; Microsoft [<i>Application name</i>] 2016 &gt; [<i>Application name</i>] Settings &gt; Security &gt; Trust Center &gt; Block macros from running in Office files from the Internet</p>
        </td>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:16px 0px 16px 30px;">
          <p>Enabled</p>
          <p>&nbsp;</p>
        </td>
      </tr>
      <tr>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:0px;">
          <p>For Outlook:</p>
          <p>&nbsp;</p>
          <p>User Configuration &gt; Administrative Templates &gt; Microsoft [<i>Application name</i>] 2016 &gt; Security &gt; Trust Center &gt; Block macros from running in Office files from the Internet</p>
          <p>&nbsp;</p>
          <p>User Configuration &gt; Administrative Templates &gt; Microsoft&nbsp;Publisher&nbsp;2016 &gt; Security &gt; Trust Center &gt; VBA Macro Notification Settings</p>
        </td>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:16px 0px 0px 30px;">
          <p>Enabled</p>
          <p>&nbsp;</p>
        </td>
      </tr>
    </tbody>
  </table>
</figure>
<p>&nbsp;</p>
<h3><strong>Configuration to limit diagnostic data sent to Microsoft</strong></h3>
<p>If your<i> organisation </i>is using the Security Policy Advisor, you will need to configure Office to allow just the <i>required diagnostic data</i> to be collected:</p>
<figure class="table" style="width:635px;">
  <table style="background-color:rgb(255, 255, 255);border-bottom:0px;border-left:0px;border-right:0px;border-top:0px;">
    <thead>
      <tr>
        <th style="border-bottom:3px solid rgb(5, 28, 72);border-left:0px;border-right:0px;border-top:0px !important;padding:0px 0px 16px;width:113px;"><strong>Group policy</strong></th>
        <th style="border-bottom:3px solid rgb(5, 28, 72);border-left:0px;border-right:0px;border-top:0px !important;padding:0px 0px 16px 30px;width:261px;"><strong>Value</strong></th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:0px;">User Configuration &gt; Administrative Templates &gt; Microsoft&nbsp;Office&nbsp;2016 &gt;&nbsp;Privacy&nbsp;&gt; Trust Center &gt;&nbsp;Configure the&nbsp;level&nbsp;of diagnostic data sent by Office to Microsoft</td>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:16px 0px 0px 30px;">
          <p>Enabled</p>
          <p>Required</p>
          <p>&nbsp;</p>
        </td>
      </tr>
    </tbody>
  </table>
</figure>
<p>&nbsp;</p>
<p>If not using the service, you can prevent diagnostic data from being collected entirely:</p>
<figure class="table" style="width:635px;">
  <table style="background-color:rgb(255, 255, 255);border-bottom:0px;border-left:0px;border-right:0px;border-top:0px;">
    <thead>
      <tr>
        <th style="border-bottom:3px solid rgb(5, 28, 72);border-left:0px;border-right:0px;border-top:0px !important;padding:0px 0px 16px;width:113px;"><strong>Group policy</strong></th>
        <th style="border-bottom:3px solid rgb(5, 28, 72);border-left:0px;border-right:0px;border-top:0px !important;padding:0px 0px 16px 30px;width:261px;"><strong>Value</strong></th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:0px;">User Configuration &gt; Administrative Templates &gt; Microsoft Office 2016 &gt; Privacy &gt; Trust Center &gt; Configure the&nbsp;level&nbsp;of diagnostic data sent by Office to Microsoft</td>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:16px 0px 0px 30px;">
          <p>Enabled</p>
          <p>Neither</p>
          <p>&nbsp;</p>
        </td>
      </tr>
    </tbody>
  </table>
</figure>
<hr>
<h2>Configuration options for macOS devices</h2>
<p>The mitigation options available on macOS can be deployed using an MDM across an enterprise. The recommended settings are available on version 16.16 of Office for Mac or newer.</p>
<p>Microsoft publishes&nbsp;<a href="https://aka.ms/macvbsec">documentation explaining preference settings</a>&nbsp;available for&nbsp;Office 2016 and Office 2019.</p>
<h3><strong>Configuration to disable the Office macro engine</strong></h3>
<p>This setting will configure all Office applications that support macros; macros cannot be disabled per-application.</p>
<figure class="table" style="height:46px;width:445px;">
  <table style="background-color:rgb(255, 255, 255);border-bottom:0px;border-left:0px;border-right:0px;border-top:0px;">
    <thead>
      <tr>
        <th style="border-bottom:3px solid rgb(5, 28, 72);border-left:0px;border-right:0px;border-top:0px !important;padding:0px 0px 16px;width:113px;"><strong>Domain</strong></th>
        <th style="border-bottom:3px solid rgb(5, 28, 72);border-left:0px;border-right:0px;border-top:0px !important;padding:0px 0px 16px 30px;width:261px;"><strong>Key</strong></th>
        <th style="border-bottom:3px solid rgb(5, 28, 72);border-left:0px;border-right:0px;border-top:0px !important;padding:0px 0px 16px 30px;"><strong>Configuration</strong></th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:0px;">com.microsoft.office&nbsp; &nbsp; &nbsp;</td>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:16px 0px 0px 30px;">VisualBasicMacroExecutionState&nbsp; &nbsp;</td>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:16px 0px 0px 30px;">DisabledWithoutWarnings&nbsp;</td>
      </tr>
    </tbody>
  </table>
</figure>
<p>&nbsp;</p>
<h3><strong>Configuration to enable recommended macro security mitigations&nbsp;</strong></h3>
<p>These settings are recommended for all Office deployments that allow any use of macros.</p>
<p>This setting will configure all Office applications that support macros; macros cannot be disabled per-application.</p>
<figure class="table" style="height:46px;width:445px;">
  <table style="background-color:rgb(255, 255, 255);border-bottom:0px;border-left:0px;border-right:0px;border-top:0px;">
    <thead>
      <tr>
        <th style="border-bottom:3px solid rgb(5, 28, 72);border-left:0px;border-right:0px;border-top:0px !important;padding:0px 0px 16px;width:113px;"><strong>Domain</strong></th>
        <th style="border-bottom:3px solid rgb(5, 28, 72);border-left:0px;border-right:0px;border-top:0px !important;padding:0px 0px 16px 30px;width:261px;"><strong>Key</strong></th>
        <th style="border-bottom:3px solid rgb(5, 28, 72);border-left:0px;border-right:0px;border-top:0px !important;padding:0px 0px 16px 30px;"><strong>Configuration</strong></th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:0px 0px 16px;">com.microsoft.office&nbsp; &nbsp; &nbsp;</td>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:16px 0px 16px 30px;">AllowVisualBasicToBindToSystem&nbsp; &nbsp;</td>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:16px 0px 16px 30px;">No</td>
      </tr>
      <tr>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:0px 0px 16px;">com.microsoft.office&nbsp; &nbsp; &nbsp;</td>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:16px 0px 16px 30px;">DisableVisualBasicExternalDylibs</td>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:16px 0px 16px 30px;">Yes</td>
      </tr>
      <tr>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:0px 0px 16px;">com.microsoft.office&nbsp; &nbsp; &nbsp;</td>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:16px 0px 16px 30px;">DisableVisualBasicToBindToPopen</td>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:16px 0px 16px 30px;">Yes</td>
      </tr>
      <tr>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:0px;">com.microsoft.office&nbsp; &nbsp; &nbsp;</td>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:16px 0px 0px 30px;">DisableVisualBasicMacScript</td>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:16px 0px 0px 30px;">Yes</td>
      </tr>
    </tbody>
  </table>
</figure>
<hr>
<h2>Comparison of Microsoft Office versions</h2>
<p>Some of the security-enabling features described above are only available in newer versions of Microsoft Office. Some features may also rely on Office being installed on a recent version of Windows 10 or macOS.</p>
<ul>
  <li>we recommend that you use the most recent version of Microsoft Office, and that all patches are applied</li>
  <li>we recommend that you use the most recent version of macOS or Windows 10, and that all patches are applied</li>
  <li>where possible, we recommend&nbsp;using the&nbsp;<a href="https://docs.microsoft.com/en-us/deployoffice/overview-of-update-channels-for-office-365-proplus">monthly channel of Office 365 ProPlus</a>&nbsp;in preference&nbsp;to&nbsp;Office 2019 or earlier</li>
  <li>we&nbsp;<strong>strongly recommend</strong>&nbsp;that you do&nbsp;<strong>not</strong>&nbsp;use versions of Microsoft&nbsp;Office that are no longer supported, including Office 2003&nbsp;and Office&nbsp;2007</li>
</ul>
<p>&nbsp;</p>
<figure class="table" style="width:666px;">
  <table style="background-color:rgb(255, 255, 255);border-bottom:0px;border-left:0px;border-right:0px;border-top:0px;">
    <tbody>
      <tr>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:0px 0px 16px;"><strong>Versions</strong></td>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:16px 0px 16px 30px;"><strong>Default Macro </strong><i><strong>Behaviour</strong></i></td>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:16px 0px;"><strong>Disable Macros</strong></td>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:16px 0px;"><strong>Disable high risk capabilities&nbsp;</strong></td>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:16px 0px;"><strong>Macro execution scanned by AV&nbsp;</strong></td>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:16px 0px;"><strong>Block from the internet&nbsp;</strong></td>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:16px 0px 16px 30px;"><strong>Trusted files (signature or location)</strong></td>
      </tr>
      <tr>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:0px 0px 16px;">Office 365 on Windows 10</td>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:16px 0px 16px 30px;">
          <p>Block until the user clicks the&nbsp;<i>Enable Macros</i>&nbsp;button.</p>
          <p>&nbsp;</p>
          <p>Macros from untrusted locations will be scanned by&nbsp;compatible&nbsp;AV.</p>
          <p>&nbsp;</p>
          <p>Macros from untrusted locations are entirely blocked when using Windows 10 in S Mode.</p>
        </td>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:16px 0px;">Per application</td>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:16px 0px;">Yes</td>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:16px 0px;">Yes</td>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:16px 0px;">Yes</td>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:16px 0px 16px 30px;">Yes</td>
      </tr>
      <tr>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:0px 0px 16px;" colspan="1">Office 365 on macOS</td>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:16px 0px 16px 30px;" colspan="1">Block until the user clicks the&nbsp;<i>Enable Macros</i>&nbsp;button</td>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:16px 0px;" colspan="1">For all applications</td>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:16px 0px;" colspan="1">Yes</td>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:16px 0px;" colspan="1">No</td>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:16px 0px;" colspan="1">No</td>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:16px 0px 16px 30px;">No</td>
      </tr>
      <tr>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:0px;" colspan="1">
          <p>Office 2019,&nbsp;2016,&nbsp;2013</p>
          <p>Office 365 on earlier versions of Windows</p>
        </td>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:16px 0px 0px 30px;" colspan="1">Block until the user clicks the&nbsp;<i>Enable Macros</i>&nbsp;button</td>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:16px 0px 0px;" colspan="1">Per application</td>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:16px 0px 0px;" colspan="1">No</td>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:16px 0px 0px;" colspan="1">No</td>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:16px 0px 0px;" colspan="1">Yes</td>
        <td style="border-bottom:none;border-left:0px;border-right:0px;border-top:1px solid rgb(170, 170, 170);padding:16px 0px 0px 30px;">Yes</td>
      </tr>
    </tbody>
  </table>
</figure>
<p>&nbsp;</p>
<p>*&nbsp;this feature was added to Office 2013 by Microsoft Update</p>
<p>Macros are supported by Office for Mac and offer similar functionality to Office running on Windows. They use a slightly different language and are run inside Apple’s sandbox. Therefore, malicious macros that are targeted at Windows versions of Office are less likely to be dangerous in Office for Mac.</p>
<p>Macros are not supported by Office Mobile apps and the Office Online browser-based document editors.&nbsp;</p>
